Index: ocaml-cohttp-1.2.0/cohttp/src/auth.ml
===================================================================
--- ocaml-cohttp-1.2.0.orig/cohttp/src/auth.ml
+++ ocaml-cohttp-1.2.0/cohttp/src/auth.ml
@@ -29,13 +29,13 @@ type credential = [
 let string_of_credential (cred:credential) =
   match cred with
   | `Basic (user, pass) ->
-    "Basic " ^ (B64.encode (sprintf "%s:%s" user pass))
+    "Basic " ^ (match (Base64.encode (sprintf "%s:%s" user pass)) with Error (`Msg msg) -> failwith msg | Ok s -> s)
   | `Other buf -> buf
 
 let credential_of_string (buf:string) : credential =
   try
     let b64 = Scanf.sscanf buf "Basic %s" (fun b -> b) in
-    match Stringext.split ~on:':' (B64.decode b64) ~max:2 with
+    match Stringext.split ~on:':' (match Base64.decode b64 with Error (`Msg msg) -> failwith msg | Ok s -> s) ~max:2 with
     |[user;pass] -> `Basic (user,pass)
     |_ -> `Other buf
   with _ -> `Other buf
